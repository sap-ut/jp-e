<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Glass Line Proforma</title>
<style>
body{font-family:Arial;background:#eef2f6;padding:10px}
.container{max-width:1500px;margin:auto;background:#fff;padding:12px;border-radius:8px}
table{width:100%;border-collapse:collapse;font-size:12px}
th,td{border:1px solid #ccc;padding:4px;text-align:center}
th{background:#0d6efd;color:#fff;white-space:nowrap}
input,select{width:100%;padding:3px;font-size:12px}
.totalbox{text-align:right;font-size:16px;margin-top:10px}
button{padding:4px 8px;cursor:pointer}
.add{background:#198754;color:#fff;border:none}
</style>
</head>

<body>
<div class="container">
<h3>Proforma Invoice – Complete Glass Line</h3>

<table id="tbl">
<thead>
<tr>
<th>Glass</th>
<th>Unit</th>
<th>W</th>
<th>H</th>
<th>Qty</th>
<th>Rate/SQM</th>
<th>SQM</th>
<th>Glass Amt</th>

<th>S-Hole Qty</th>
<th>S-Hole Rate</th>
<th>S-Hole Amt</th>

<th>B-Hole Qty</th>
<th>B-Hole Rate</th>
<th>B-Hole Amt</th>

<th>Cut Qty</th>
<th>Cut Rate</th>
<th>Cut Amt</th>

<th>Polish</th>
<th>Polish Rate</th>
<th>Polish Amt</th>

<th>Tough</th>
<th>Tough Rate</th>
<th>Tough Amt</th>

<th>Lami</th>
<th>Lami Rate</th>
<th>Lami Amt</th>

<th>Line Total</th>
<th>X</th>
</tr>
</thead>

<tbody>
<tr>
<td><input value="Toughened"></td>
<td>
<select onchange="calc()">
<option value="mm">mm</option>
<option value="inch">inch</option>
</select>
</td>

<td><input value="1000" oninput="calc()"></td>
<td><input value="2000" oninput="calc()"></td>
<td><input value="1" oninput="calc()"></td>
<td><input value="150" oninput="calc()"></td>

<td class="sqm">0</td>
<td class="gamt">0</td>

<td><input value="0" oninput="calc()"></td>
<td><input value="0" oninput="calc()"></td>
<td class="shamt">0</td>

<td><input value="0" oninput="calc()"></td>
<td><input value="0" oninput="calc()"></td>
<td class="bhamt">0</td>

<td><input value="0" oninput="calc()"></td>
<td><input value="0" oninput="calc()"></td>
<td class="cutamt">0</td>

<td>
<select onchange="calc()">
<option value="0">None</option>
<option value="1">Normal</option>
<option value="2">Diamond</option>
</select>
</td>
<td><input value="0" oninput="calc()"></td>
<td class="polamt">0</td>

<td>
<select onchange="calc()">
<option value="0">No</option>
<option value="1">Yes</option>
</select>
</td>
<td><input value="0" oninput="calc()"></td>
<td class="tamt">0</td>

<td>
<select onchange="calc()">
<option value="0">No</option>
<option value="1">Yes</option>
</select>
</td>
<td><input value="0" oninput="calc()"></td>
<td class="lamamt">0</td>

<td class="total">0</td>
<td><button onclick="delRow(this)">❌</button></td>
</tr>
</tbody>
</table>

<button class="add" onclick="addRow()">+ Add Row</button>

<div class="totalbox">
<p>Subtotal: ₹ <span id="sub">0</span></p>
<p>GST 18%: ₹ <span id="gst">0</span></p>
<p><b>Grand Total: ₹ <span id="grand">0</span></b></p>
</div>
</div>

<script>
function calc(){
let rows=document.querySelectorAll("#tbl tbody tr");
let subtotal=0;

rows.forEach(r=>{
let unit=r.cells[1].children[0].value;
let w=+r.cells[2].children[0].value||0;
let h=+r.cells[3].children[0].value||0;
let q=+r.cells[4].children[0].value||0;
let rate=+r.cells[5].children[0].value||0;

if(unit==="inch"){ w*=25.4; h*=25.4; }

let sqm=(w*h*q)/1000000;
let glassAmt=sqm*rate;

let sh=+r.cells[8].children[0].value||0;
let shr=+r.cells[9].children[0].value||0;
let shAmt=sh*shr;

let bh=+r.cells[11].children[0].value||0;
let bhr=+r.cells[12].children[0].value||0;
let bhAmt=bh*bhr;

let cutq=+r.cells[14].children[0].value||0;
let cutr=+r.cells[15].children[0].value||0;
let cutAmt=cutq*cutr;

let polType=r.cells[17].children[0].value;
let polRate=+r.cells[18].children[0].value||0;
let polAmt=(polType>0)?sqm*polRate:0;

let tough=r.cells[20].children[0].value;
let toughRate=+r.cells[21].children[0].value||0;
let toughAmt=(tough==1)?sqm*toughRate:0;

let lam=r.cells[23].children[0].value;
let lamRate=+r.cells[24].children[0].value||0;
let lamAmt=(lam==1)?sqm*lamRate:0;

let total=glassAmt+shAmt+bhAmt+cutAmt+polAmt+toughAmt+lamAmt;

r.querySelector(".sqm").innerText=sqm.toFixed(3);
r.querySelector(".gamt").innerText=glassAmt.toFixed(2);
r.querySelector(".shamt").innerText=shAmt.toFixed(2);
r.querySelector(".bhamt").innerText=bhAmt.toFixed(2);
r.querySelector(".cutamt").innerText=cutAmt.toFixed(2);
r.querySelector(".polamt").innerText=polAmt.toFixed(2);
r.querySelector(".tamt").innerText=toughAmt.toFixed(2);
r.querySelector(".lamamt").innerText=lamAmt.toFixed(2);
r.querySelector(".total").innerText=total.toFixed(2);

subtotal+=total;
});

let gst=subtotal*0.18;
sub.innerText=subtotal.toFixed(2);
gstEl.innerText=gst.toFixed(2);
grand.innerText=(subtotal+gst).toFixed(2);
}

function addRow(){
let tr=document.querySelector("#tbl tbody tr").cloneNode(true);
tr.querySelectorAll("input").forEach(i=>i.value=0);
document.querySelector("#tbl tbody").appendChild(tr);
}

function delRow(b){
b.parentElement.parentElement.remove();
calc();
}

const gstEl=document.getElementById("gst");
const grand=document.getElementById("grand");

calc();
</script>
</body>
</html>
